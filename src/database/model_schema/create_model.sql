-- MySQL Script generated by MySQL Workbench
-- Sun Nov  6 21:45:13 2022
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema TPO
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema TPO
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `TPO` DEFAULT CHARACTER SET utf8 ;
USE `TPO` ;

-- -----------------------------------------------------
-- Table `TPO`.`country`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `TPO`.`country` ;

CREATE TABLE IF NOT EXISTS `TPO`.`country` (
  `code` VARCHAR(3) NOT NULL,
  `name` VARCHAR(145) NOT NULL,
  PRIMARY KEY (`code`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `TPO`.`city`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `TPO`.`city` ;

CREATE TABLE IF NOT EXISTS `TPO`.`city` (
  `code` VARCHAR(20) NOT NULL,
  `name` VARCHAR(145) NOT NULL,
  `country_code` VARCHAR(3) NOT NULL,
  `latitude` VARCHAR(7) NOT NULL,
  `longitude` VARCHAR(7) NOT NULL,
  PRIMARY KEY (`code`, `country_code`, `name`),
  INDEX `fk_city_country_idx` (`country_code` ASC) VISIBLE,
  CONSTRAINT `fk_city_country`
    FOREIGN KEY (`country_code`)
    REFERENCES `TPO`.`country` (`code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `TPO`.`street`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `TPO`.`street` ;

CREATE TABLE IF NOT EXISTS `TPO`.`street` (
  `street_name` VARCHAR(150) NOT NULL,
  `street_number` INT NOT NULL,
  `city_code` VARCHAR(20) NOT NULL,
  `city_name` VARCHAR(145) NOT NULL,
  `country_code` VARCHAR(3) NOT NULL,
  PRIMARY KEY (`street_name`, `street_number`, `city_code`, `city_name`, `country_code`),
  INDEX `fk_street_city1_idx` (`city_code` ASC, `country_code` ASC, `city_name` ASC) VISIBLE,
  CONSTRAINT `fk_street_city1`
    FOREIGN KEY (`city_code` , `country_code` , `city_name`)
    REFERENCES `TPO`.`city` (`code` , `country_code` , `name`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `TPO`.`customer`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `TPO`.`customer` ;

CREATE TABLE IF NOT EXISTS `TPO`.`customer` (
  `username` VARCHAR(10) NOT NULL,
  `name` VARCHAR(85) NOT NULL,
  `surname` VARCHAR(85) NOT NULL,
  `company_name` VARCHAR(85) NULL,
  `tel_num` VARCHAR(45) NOT NULL,
  `street_name` VARCHAR(150) NOT NULL,
  `street_number` INT NOT NULL,
  `city_code` VARCHAR(20) NOT NULL,
  `city_name` VARCHAR(145) NOT NULL,
  `country_code` VARCHAR(3) NOT NULL,
  PRIMARY KEY (`username`),
  INDEX `fk_customer_street1_idx` (`street_name` ASC, `street_number` ASC, `city_code` ASC, `city_name` ASC, `country_code` ASC) VISIBLE,
  CONSTRAINT `fk_customer_street1`
    FOREIGN KEY (`street_name` , `street_number` , `city_code` , `city_name` , `country_code`)
    REFERENCES `TPO`.`street` (`street_name` , `street_number` , `city_code` , `city_name` , `country_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `TPO`.`parcel_status`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `TPO`.`parcel_status` ;

CREATE TABLE IF NOT EXISTS `TPO`.`parcel_status` (
  `id` INT NOT NULL,
  `name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `TPO`.`parcel`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `TPO`.`parcel` ;

CREATE TABLE IF NOT EXISTS `TPO`.`parcel` (
  `id` VARCHAR(8) NOT NULL,
  `parcel_status_id` INT NOT NULL,
  `sender` VARCHAR(10) NOT NULL,
  `sender_street_name` VARCHAR(150) NOT NULL,
  `sender_street_number` INT NOT NULL,
  `sender_city_code` VARCHAR(20) NOT NULL,
  `sender_city_name` VARCHAR(145) NOT NULL,
  `sender_country_code` VARCHAR(3) NOT NULL,
  `recipient` VARCHAR(10) NOT NULL,
  `recipient_street_name` VARCHAR(150) NOT NULL,
  `recipient_street_number` INT NOT NULL,
  `recipient_city_code` VARCHAR(20) NOT NULL,
  `recipient_city_name` VARCHAR(145) NOT NULL,
  `recipient_country_code` VARCHAR(3) NOT NULL,
  `weight` DOUBLE NOT NULL,
  `height` INT NOT NULL,
  `width` INT NOT NULL,
  `depth` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_parcel_customer1_idx` (`sender` ASC) VISIBLE,
  INDEX `fk_parcel_customer2_idx` (`recipient` ASC) VISIBLE,
  INDEX `fk_parcel_parcel_status1_idx` (`parcel_status_id` ASC) VISIBLE,
  INDEX `fk_parcel_street1_idx` (`sender_street_name` ASC, `sender_street_number` ASC, `sender_city_code` ASC, `sender_city_name` ASC, `sender_country_code` ASC) VISIBLE,
  INDEX `fk_parcel_street2_idx` (`recipient_street_name` ASC, `recipient_street_number` ASC, `recipient_city_code` ASC, `recipient_city_name` ASC, `recipient_country_code` ASC) VISIBLE,
  CONSTRAINT `fk_parcel_customer1`
    FOREIGN KEY (`sender`)
    REFERENCES `TPO`.`customer` (`username`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_parcel_customer2`
    FOREIGN KEY (`recipient`)
    REFERENCES `TPO`.`customer` (`username`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_parcel_parcel_status1`
    FOREIGN KEY (`parcel_status_id`)
    REFERENCES `TPO`.`parcel_status` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_parcel_street1`
    FOREIGN KEY (`sender_street_name` , `sender_street_number` , `sender_city_code` , `sender_city_name` , `sender_country_code`)
    REFERENCES `TPO`.`street` (`street_name` , `street_number` , `city_code` , `city_name` , `country_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_parcel_street2`
    FOREIGN KEY (`recipient_street_name` , `recipient_street_number` , `recipient_city_code` , `recipient_city_name` , `recipient_country_code`)
    REFERENCES `TPO`.`street` (`street_name` , `street_number` , `city_code` , `city_name` , `country_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `TPO`.`branch_type`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `TPO`.`branch_type` ;

CREATE TABLE IF NOT EXISTS `TPO`.`branch_type` (
  `id` INT NOT NULL,
  `name(45)` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `TPO`.`branch`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `TPO`.`branch` ;

CREATE TABLE IF NOT EXISTS `TPO`.`branch` (
  `id` INT NOT NULL,
  `branch_type_id` INT NOT NULL,
  `name` VARCHAR(45) NOT NULL,
  `street_name` VARCHAR(150) NOT NULL,
  `street_number` INT NOT NULL,
  `city_code` VARCHAR(20) NOT NULL,
  `city_name` VARCHAR(145) NOT NULL,
  `country_code` VARCHAR(3) NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_branch_branch_type1_idx` (`branch_type_id` ASC) VISIBLE,
  INDEX `fk_branch_street1_idx` (`street_name` ASC, `street_number` ASC, `city_code` ASC, `city_name` ASC, `country_code` ASC) VISIBLE,
  CONSTRAINT `fk_branch_branch_type1`
    FOREIGN KEY (`branch_type_id`)
    REFERENCES `TPO`.`branch_type` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_branch_street1`
    FOREIGN KEY (`street_name` , `street_number` , `city_code` , `city_name` , `country_code`)
    REFERENCES `TPO`.`street` (`street_name` , `street_number` , `city_code` , `city_name` , `country_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `TPO`.`staff_role`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `TPO`.`staff_role` ;

CREATE TABLE IF NOT EXISTS `TPO`.`staff_role` (
  `id` INT NOT NULL,
  `role_name` VARCHAR(65) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `TPO`.`staff`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `TPO`.`staff` ;

CREATE TABLE IF NOT EXISTS `TPO`.`staff` (
  `username` VARCHAR(10) NOT NULL,
  `name` VARCHAR(85) NOT NULL,
  `surname` VARCHAR(85) NOT NULL,
  `branch_id` INT NOT NULL,
  `staff_role_id` INT NOT NULL,
  PRIMARY KEY (`username`),
  INDEX `fk_staff_branch1_idx` (`branch_id` ASC) VISIBLE,
  INDEX `fk_staff_staff_role1_idx` (`staff_role_id` ASC) VISIBLE,
  CONSTRAINT `fk_staff_branch1`
    FOREIGN KEY (`branch_id`)
    REFERENCES `TPO`.`branch` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_staff_staff_role1`
    FOREIGN KEY (`staff_role_id`)
    REFERENCES `TPO`.`staff_role` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `TPO`.`job_type`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `TPO`.`job_type` ;

CREATE TABLE IF NOT EXISTS `TPO`.`job_type` (
  `id` INT NOT NULL,
  `name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `TPO`.`job_status`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `TPO`.`job_status` ;

CREATE TABLE IF NOT EXISTS `TPO`.`job_status` (
  `id` INT NOT NULL,
  `name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `TPO`.`job`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `TPO`.`job` ;

CREATE TABLE IF NOT EXISTS `TPO`.`job` (
  `id` INT NOT NULL,
  `date_created` DATETIME NOT NULL,
  `date_completed` DATETIME NULL,
  `job_type_id` INT NOT NULL,
  `job status_id` INT NOT NULL,
  `staff_username` VARCHAR(10) NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_job_job_type1_idx` (`job_type_id` ASC) VISIBLE,
  INDEX `fk_job_job status1_idx` (`job status_id` ASC) VISIBLE,
  INDEX `fk_job_staff1_idx` (`staff_username` ASC) VISIBLE,
  CONSTRAINT `fk_job_job_type1`
    FOREIGN KEY (`job_type_id`)
    REFERENCES `TPO`.`job_type` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_job_job status1`
    FOREIGN KEY (`job status_id`)
    REFERENCES `TPO`.`job_status` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_job_staff1`
    FOREIGN KEY (`staff_username`)
    REFERENCES `TPO`.`staff` (`username`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `TPO`.`job_packet`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `TPO`.`job_packet` ;

CREATE TABLE IF NOT EXISTS `TPO`.`job_packet` (
  `job_id` INT NOT NULL,
  `parcel_id` VARCHAR(8) NOT NULL,
  PRIMARY KEY (`job_id`, `parcel_id`),
  INDEX `fk_job_packet_parcel1_idx` (`parcel_id` ASC) VISIBLE,
  CONSTRAINT `fk_job_packet_job1`
    FOREIGN KEY (`job_id`)
    REFERENCES `TPO`.`job` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_job_packet_parcel1`
    FOREIGN KEY (`parcel_id`)
    REFERENCES `TPO`.`parcel` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
